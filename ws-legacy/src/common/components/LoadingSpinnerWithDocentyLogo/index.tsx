import { useEffect, useState } from "react";
import styles from "./index.module.css";

export function LoadingSpinnerWithDocentyLogo({
  isDone,
  isLoading,
}: {
  isDone?: boolean;
  isLoading?: boolean;
}) {
  const [isVisible, setIsVisible] = useState(false);
  const [isLogoVisible, setIsLogoVisible] = useState(false);
  useEffect(() => {
    let id: NodeJS.Timeout;
    if (isLoading) setIsVisible(true);
    if (isDone) {
      setIsLogoVisible(true);
      id = setTimeout(() => setIsVisible(false), 2000);
    }

    return () => {
      setIsVisible(false);
      setIsLogoVisible(false);
      clearTimeout(id);
    };
  }, [isDone, isLoading]);

  if (!isVisible) return null;

  return (
    <div className="relative flex w-full items-center justify-center">
      <div className={styles.spinner}>
        <div />
        <div />
        <div />
      </div>
      {isLogoVisible && (
        <div className={styles.logo}>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="16"
            height="18"
            viewBox="0 0 16 18"
            fill="none"
          >
            <g clip-path="url(#clip0_67_3109)">
              <rect width="16" height="18" fill="#1FD8B6" />
              <path
                d="M6.90239 9.66504H6.05921C5.91641 9.66504 5.80762 9.7793 5.80762 9.91373V11.2715C5.80762 11.4126 5.92321 11.5202 6.05921 11.5202H6.90239C7.04519 11.5202 7.15398 11.4059 7.15398 11.2715V9.91373C7.15398 9.77258 7.03839 9.66504 6.90239 9.66504Z"
                fill="white"
              />
              <path
                d="M9.92778 9.66504H9.0846C8.94181 9.66504 8.83301 9.7793 8.83301 9.91373V11.2715C8.83301 11.4126 8.9486 11.5202 9.0846 11.5202H9.92778C10.0706 11.5202 10.1794 11.4059 10.1794 11.2715V9.91373C10.1794 9.77258 10.0638 9.66504 9.92778 9.66504Z"
                fill="white"
              />
              <path
                d="M15.3608 9.82653H14.7828C14.572 8.79815 14.0348 7.78321 13.1849 6.94303C13.1849 6.94303 11.3693 4.88627 8.53379 4.6443C8.52699 4.6443 8.52019 4.6443 8.51339 4.6443C8.43179 4.6443 8.35699 4.63086 8.27539 4.63086C8.18019 4.63086 8.0918 4.63086 7.9966 4.63086C7.9014 4.63086 7.813 4.63086 7.71781 4.63086C7.63621 4.63086 7.55461 4.63758 7.47981 4.6443C7.47301 4.6443 7.46621 4.6443 7.45941 4.6443C4.62388 4.88627 2.80833 6.94303 2.80833 6.94303C1.96515 7.77649 1.42796 8.79815 1.21037 9.82653H0.632384C0.285593 9.82653 0 10.1088 0 10.4516V11.9908C0 12.3336 0.285593 12.6159 0.632384 12.6159H1.13557C1.33277 14.256 2.74033 15.5263 4.44709 15.5263H8.0714L12.3689 17.8183C13.1509 18.3157 14.1844 17.7578 14.1844 16.837V14.2627C14.5516 13.7989 14.8032 13.2343 14.8712 12.6159H15.3676C15.7144 12.6159 16 12.3336 16 11.9908V10.4516C16 10.1088 15.7144 9.82653 15.3676 9.82653H15.3608ZM12.5729 12.3874C12.5729 12.9318 12.1309 13.3687 11.5801 13.3687H11.5053V14.6996C11.5053 14.8273 11.3625 14.9012 11.2605 14.834L8.98257 13.3754H4.40629C3.8555 13.3754 3.41351 12.9386 3.41351 12.3941V9.16783C3.41351 8.62339 3.8555 8.1865 4.40629 8.1865H11.5801C12.1309 8.1865 12.5729 8.62339 12.5729 9.16783V12.3941V12.3874Z"
                fill="white"
              />
              <path
                d="M6.00383 4.30172C6.45262 4.16057 6.93541 4.05302 7.459 4.00597C7.4658 4.00597 7.4726 4.00597 7.4794 4.00597C7.56099 4.00597 7.63579 3.99253 7.71739 3.99253C7.81259 3.99253 7.90099 3.99253 7.99618 3.99253C8.09138 3.99253 8.17978 3.99253 8.27498 3.99253C8.35658 3.99253 8.43817 3.99925 8.51297 4.00597C8.51977 4.00597 8.52657 4.00597 8.53337 4.00597C9.05016 4.0463 9.53975 4.15385 9.98853 4.30172C9.87294 3.43465 9.19295 2.74235 8.32258 2.60119V1.73413C8.66257 1.60642 8.90056 1.27707 8.90056 0.900672C8.90056 0.403286 8.49257 0 7.98938 0C7.4862 0 7.07821 0.403286 7.07821 0.900672C7.07821 1.28379 7.3162 1.60642 7.65619 1.73413V2.60119C6.78581 2.74235 6.10583 3.43465 5.99023 4.30172H6.00383Z"
                fill="white"
              />
            </g>
            <defs>
              <clipPath id="clip0_67_3109">
                <rect width="16" height="18" fill="white" />
              </clipPath>
            </defs>
          </svg>
        </div>
      )}
    </div>
  );
}
